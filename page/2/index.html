<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Bulijiojio Blog">
<meta property="og:url" content="https://example.com/page/2/index.html">
<meta property="og:site_name" content="Bulijiojio Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="YXY">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Bulijiojio Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Bulijiojio Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">日常摸鱼划水的虾皮--如果公式不能正常显示请使用Chrome浏览器并安装Tex All the Things插件</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://example.com/2020/06/28/%E7%9B%AE%E6%A0%87%E8%B7%9F%E8%B8%AA%E6%BB%A4%E6%B3%A2%E9%A2%84%E6%B5%8B/%E9%9D%9E%E6%9C%BA%E5%8A%A8%E7%9B%AE%E6%A0%87%E8%B7%9F%E8%B8%AA%E4%B8%8E%E6%9C%80%E4%BC%98%E6%BB%A4%E6%B3%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YXY">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bulijiojio Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/28/%E7%9B%AE%E6%A0%87%E8%B7%9F%E8%B8%AA%E6%BB%A4%E6%B3%A2%E9%A2%84%E6%B5%8B/%E9%9D%9E%E6%9C%BA%E5%8A%A8%E7%9B%AE%E6%A0%87%E8%B7%9F%E8%B8%AA%E4%B8%8E%E6%9C%80%E4%BC%98%E6%BB%A4%E6%B3%A2/" class="post-title-link" itemprop="url">非机动目标跟踪与最优滤波</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-28 21:01:30" itemprop="dateCreated datePublished" datetime="2020-06-28T21:01:30+08:00">2020-06-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-04-01 21:46:15" itemprop="dateModified" datetime="2021-04-01T21:46:15+08:00">2021-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tracking/" itemprop="url" rel="index"><span itemprop="name">Tracking</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="非机动目标跟踪与最优滤波"><a href="#非机动目标跟踪与最优滤波" class="headerlink" title="非机动目标跟踪与最优滤波"></a>非机动目标跟踪与最优滤波</h1><h2 id="目标跟踪中的最优贝叶斯滤波"><a href="#目标跟踪中的最优贝叶斯滤波" class="headerlink" title="目标跟踪中的最优贝叶斯滤波"></a>目标跟踪中的最优贝叶斯滤波</h2><p>目标动态方程：$\mathbf{x}<em>k = g(\mathbf{x}</em>{k-1},\mathbf{v}_k)$</p>
<p>传感器观测方程：$\mathbf{y}<em>k = l(\mathbf{x}</em>{k},\mathbf{w}_k)$</p>
<p>由目标动态方程可以得到转移密度函数$p(\mathbf{x}<em>k \mid \mathbf{x}</em>{k-1})$<br>由传感器观测方程可以得到似然函数$p(\mathbf{y}_k \mid \mathbf{x}_k)$<br>要注意一点是当$g,l$都是线性并且$\mathbf{v}_k$和$\mathbf{w}_k$是高斯噪声时，$\mathbf{x}_k$的后验概率密度时高斯形式的。</p>
<p>一步预测</p>
<p>$$p\left(\mathbf{x}<em>{k} \mid \mathbf{y}^{k-1}\right)=\int p\left(\mathbf{x}</em>{k} \mid \mathbf{x}<em>{k-1}\right) p\left(\mathbf{x}</em>{k-1} \mid \mathbf{y}^{k-1}\right) \mathrm{d} \mathbf{x}_{k-1}$$</p>
<p>后验概率密度函数更新</p>
<p>$$<br>p\left(\mathbf{x}<em>{k} \mid \mathbf{y}^{k}\right)=\frac{1}{p\left(\mathbf{y}</em>{k} \mid \mathbf{y}^{k-1}\right)} p\left(\mathbf{y}<em>{k} \mid \mathbf{x}</em>{k}\right) p\left(\mathbf{x}_{k} \mid \mathbf{y}^{k-1}\right)<br>$$</p>
<h2 id="最优非机动目标跟踪滤波"><a href="#最优非机动目标跟踪滤波" class="headerlink" title="最优非机动目标跟踪滤波"></a>最优非机动目标跟踪滤波</h2><p>目标动态方程：$\mathbf{x}<em>k = f(\mathbf{x}</em>{k-1})+\mathbf{v}<em>k$<br>转移密度函数：$p(\mathbf{x}</em>{k}\mid \mathbf{x}<em>{k-1}) = p</em>{\mathbf{v}_{k}}(\mathbf{x}<em>k -f(\mathbf{x}</em>{k-1}) )$</p>
<p>传感器观测方程：$\mathbf{y}<em>k = h(\mathbf{x}</em>{k})+\mathbf{w}<em>k$<br>似然函数：$p(\mathbf{y}</em>{k}\mid \mathbf{x}<em>{k}) = p</em>{\mathbf{w}_{k}}(\mathbf{y}<em>k -h(\mathbf{x}</em>{k}) )$</p>
<p>计算后验概率密度函数<br>$$<br>p\left(x_{k} \mid y^{k}\right) =\frac{p_{w_{k}}\left(y_{k}-h\left(x_{k}\right)\right) \int p_{v_{k}}\left(x_{k}-f\left(x_{k-1}\right)\right) p\left(x_{k-1} \mid y^{k-1}\right) d x_{k-1}}{\int p_{w_{k}}\left(y_{k}-h\left(x_{k}\right)\right) p\left(x_{k} \mid y^{k-1}\right) d x_{k}}<br>$$</p>
<p>其中</p>
<p>$$<br>p\left(x_{k} \mid y^{k-1}\right) =\int p_{v_{k}}\left(x_{k}-f\left(x_{k-1}\right)\right) p\left(x_{k-1} \mid y^{k-1}\right) d x_{k-1}<br>$$</p>
<p>应用上式的不同假设条件有：<br><strong>A1</strong> 目标动态和观测方程是线性的：</p>
<p>$$<br>\begin{array}{l}<br>\mathbf{x}<em>{k}= \mathbf{F} \mathbf{x}</em>{k-1}+\mathbf{v}<em>{k} \<br>\mathbf{y}</em>{k}=\mathbf{H} x_{k}+\mathbf{w}_{k}<br>\end{array}<br>$$</p>
<p><strong>A2</strong> $\mathbf{v}<em>{k}$ 和 $\mathbf{w}</em>{k}$ 是均值为突且噪声协方差分别为 $\mathbf{Q}<em>{k}$ 和 $\mathbf{R}</em>{k}$ 的高斯白噪声<br><strong>A3</strong> $k-1$ 时刻后验概率密度 $p\left(\mathbf{x}<em>{k-1} \mid \mathbf{y}^{k-1}\right)$ 是均值为 $\hat{\mathbf{x}}</em>{k-1| k-1}$，方差为$\mathbf{P}_{k-1 | k-1}$的高斯形式。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://example.com/2020/03/01/%E9%9B%B7%E8%BE%BE%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/PDradar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YXY">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bulijiojio Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/01/%E9%9B%B7%E8%BE%BE%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/PDradar/" class="post-title-link" itemprop="url">PDradar</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-01 21:56:47" itemprop="dateCreated datePublished" datetime="2020-03-01T21:56:47+08:00">2020-03-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-04-01 22:02:33" itemprop="dateModified" datetime="2021-04-01T22:02:33+08:00">2021-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Radar-Signal-Processing/" itemprop="url" rel="index"><span itemprop="name">Radar Signal Processing</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="雷达信号处理基基础"><a href="#雷达信号处理基基础" class="headerlink" title="雷达信号处理基基础"></a>雷达信号处理基基础</h1><h2 id="脉冲体制"><a href="#脉冲体制" class="headerlink" title="脉冲体制"></a>脉冲体制</h2><h3 id="回波信号分析"><a href="#回波信号分析" class="headerlink" title="回波信号分析"></a>回波信号分析</h3><p>以线性调频（LFM）为例，在一次发射周期中，发射信号相位为</p>
<p>$$<br>P_T = 2 \pi (f_R t + \frac{k}{2}t^2)+\phi_T<br>$$</p>
<p>发射时刻与接收到回波的时刻间时延为（v为径向速度且为匀速）</p>
<p>$$<br>\tau(t) =\frac{2(R - vt)}{c}<br>$$</p>
<p>接收信号相位为</p>
<p>$$<br>\begin{array}{c}<br>  P_R &amp; = 2 \pi (f_R (t-\tau(t)) + \frac{k}{2} (t-\tau(t))^2)+\phi_T+\phi_R \<br>      &amp; = 2 \pi (f_R (t - \frac{2R }{c}) + \frac{2v f_R t}{c} + \frac{k}{2} ((1+\frac{2v}{c})t-\frac{2R}{c})^2)+\phi_T+\phi_R<br>\end{array}<br>$$</p>
<p>那么经过前级的处理可以得到中频信号的相位为</p>
<p>$$<br>P_{IF} = 2 \pi ((f_I-\frac{B}{2}) (t - \frac{2R }{c}) + \frac{2v f_R t}{c} + \frac{k}{2} ((1+\frac{2v}{c})t-\frac{2R}{c})^2)+\phi_{IF}<br>$$</p>
<p>假设再一次相参处理过程中脉冲积累数为M，那么第n次脉冲周期中（T）$1 \leq n \leq M$</p>
<p>$$<br>\tau_n(t) = \frac{2(R_n-vt)}{c} =  \frac{2(R_0-vt- v(n-1)T)}{c}<br>$$</p>
<p>$$<br>\begin{array}{c}<br>P_{IF_n} &amp; = 2 \pi ((f_I-\frac{B}{2}) t - \frac{2R_n (f_I-\frac{B}{2})}{c} + \frac{2v f_R t}{c} + \frac{k}{2} ((1+\frac{2v}{c})t-\frac{2R_n}{c})^2)+\phi_{IF} \<br>&amp; = 2 \pi {(f_I-\frac{B}{2}) (t - \tau_n ) + \frac{2v f_R t}{c} + \frac{k}{2} [(1+\frac{2v}{c})t-\tau_n]^2}+\phi_{IF}<br>\<br>&amp;(\tau_n \leq t \leq T*DR+\tau_n)<br>\end{array}<br>$$</p>
<p>其中 $R_n = R_{0} - v(n-1)T$ , $\tau_n = \frac{2R_n}{c} = \tau_n(0)$,$DR$ 为占空比。</p>
<p>注：</p>
<ul>
<li><p>$P_{IF}=P_R-P_L$,其中本振信号相位$P_D=2\pi(t-\frac{2R}c+\phi_D)(f_R-f_I+\frac B 2)$，$\phi_D$最终归入$\phi_{IF}$这个系数中，后级处理暂不考虑。</p>
</li>
<li><p>$R_n$指第n个脉冲发射时刻，目标与雷达之间的距离，因此$R_n=R_0-v(n-1)$</p>
</li>
<li><p>$\tau_n$由如下得到：<br>$\tau_n=\frac {2(R_n-v\frac {\tau_n} 2)}{c} \Rightarrow\tau_n=\frac{2R_n}{c+v}$<br>解得 $\tau_n=\frac{2R_n}{c+v}$<br>因此，$\tau_n=\frac{2R_n}{c+v}\approx\frac{2R_n}{c}=\frac{2(R_0-v(n-1)T)}{c}$,当$R_0 \gg v(n-1)T $时，$\tau_n \approx \tau_0$。</p>
</li>
</ul>
<h3 id="匹配滤波原理简述"><a href="#匹配滤波原理简述" class="headerlink" title="匹配滤波原理简述"></a>匹配滤波原理简述</h3><p>匹配滤波器（match filter）是最佳线性滤波器的一种，该滤波器的准则是输出信噪比最大，常用于通信、雷达等系统的接收机中，下面对其冲激响应/系统函数进行推导。</p>
<p>设该滤波器传递函数为$H(f)$，冲激响应为$h(t)$，输入信号为<br>$$<br>r(t)=s(t)+n(t)<br>$$</p>
<p>其中$s(t)$为输入信号，$n(t)$为高斯白噪声。</p>
<p>设输入信号的频谱密度函数为$S(f)$，而高斯白噪声的单边功率谱为$\frac{n_0}2$，其中$n_0$为高斯白噪声单边功率谱密度。</p>
<p>那么经过系统响应函数为$H(j\omega)$的LTI系统后，设$s_0(t)$为信号的输出，其大小为</p>
<p>$$<br>s_{0}(t) = \int_{-\infty }^{+\infty}H(f)S(f)e^{j2\pi ft}df<br>$$</p>
<p>而又已知输出高斯白噪声的功率谱密度等于输入白噪声的功率谱密度乘以系统传递函数模值的平方，即输出噪声功率为：</p>
<p>$$<br>N_0 = \frac{n_0}{2}\int_{-\infty }^{+\infty }|H(f)|^{2}df<br>$$</p>
<p>因此，在采样时刻$t_0$上，输出信号瞬时功率和噪声平均功率之比为：</p>
<p>$$<br>r_0 = \frac{|s_0(t_0)|^2}{N_0}=\frac{|\int_{-\infty }^{+\infty}H(f)S(f)e^{j2\pi ft}df)|^2}{\frac{n_0}{2}\int_{-\infty }^{+\infty}|H(f)|^2df}<br>$$</p>
<p>利用柯西-施瓦兹不等式</p>
<p>$$<br>|\int_{-\infty }^{+\infty}f_1(x)f_2(x)dx|^2 \leq \int_{-\infty }^{+\infty}|f_1(x)|^2dx\int_{-\infty }^{+\infty}|f_2(x)|^2dx<br>$$</p>
<p>该等式当且仅当$f_1(x) = kf^{*}_{2}(x)$时取最大值,其中$k$为任意常数。那么令$f_1(x) = H(f),f_2(x)=H(f)e^{j2\pi ft_0}$可以得到：</p>
<p>$$<br>r_0 \leq \frac{\int_{-\infty }^{+\infty}|H(f)|^2dx\int_{-\infty }^{+\infty}|S(f)|^2dx}{\frac{n_0}{2}\int_{-\infty }^{+\infty}|H(f)|^2df} = \frac{\int_{-\infty }^{+\infty}|S(f)|^2df}{\frac{n_0}{2}} = \frac{2E}{n_0}<br>$$</p>
<p>其中E为信号的能量。而且当且仅当$H(f) = k S^*(f)e^{-j2\pi ft_0}$时，$r_0$取得最大值。</p>
<p>对$H(f)$求逆FFT变换，可得滤波器的冲激响应</p>
<p>$$<br>h(t) = ks^*(t_0 -t)<br>$$</p>
<p>由上式可知匹配滤波器的冲激响应就是信$s(t)$的镜像，只不过存在一个$t_0$的时延。<br>也可以将匹配滤波的过程理解为一个求相关的过程，当$t_0$时刻信号进入滤波器时，与滤波器系数进行卷积，相当于求自相关，很明显要远大于白噪声和滤波器系数的互相关，此时信噪比可达到最大。</p>
<h3 id="仿真"><a href="#仿真" class="headerlink" title="仿真"></a>仿真</h3><h4 id="参数设计"><a href="#参数设计" class="headerlink" title="参数设计"></a>参数设计</h4><p>首先进行参数设计</p>
<figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">c <span class="built_in">=</span> <span class="number">3</span>e8;         <span class="comment">%光速</span></span><br><span class="line">RF <span class="built_in">=</span> <span class="number">35</span>e9;       <span class="comment">%射频频率</span></span><br><span class="line">lambda <span class="built_in">=</span> c/RF;   <span class="comment">%射频波长</span></span><br><span class="line">f0 <span class="built_in">=</span> <span class="number">85</span>e6;       <span class="comment">%中频  85MHz</span></span><br><span class="line">fs <span class="built_in">=</span> <span class="number">80</span>e6;       <span class="comment">%采样率  80MHz</span></span><br><span class="line">T <span class="built_in">=</span> <span class="number">50</span>e-<span class="number">6</span>;       <span class="comment">%脉冲重复周期  500u</span></span><br><span class="line"></span><br><span class="line">DutyRatio <span class="built_in">=</span> <span class="number">0.1</span>;           <span class="comment">%占空比</span></span><br><span class="line">Tp <span class="built_in">=</span> DutyRatio * T;        <span class="comment">%脉冲持续时间  5us</span></span><br><span class="line">tp <span class="built_in">=</span> <span class="number">0</span>:<span class="number">1</span>/fs:Tp-<span class="number">1</span>/fs;</span><br><span class="line">NTp <span class="built_in">=</span> length(tp);          <span class="comment">%脉冲采样点数</span></span><br><span class="line"></span><br><span class="line">B <span class="built_in">=</span> <span class="number">10</span>e6;         <span class="comment">%调频带宽  10MHz</span></span><br><span class="line">k <span class="built_in">=</span> B/Tp;         <span class="comment">%调频斜率=带宽/脉冲持续时间</span></span><br><span class="line"></span><br><span class="line">M <span class="built_in">=</span> <span class="number">32</span>;           <span class="comment">%发射脉冲数/脉冲积累数</span></span><br><span class="line"></span><br><span class="line">t <span class="built_in">=</span> <span class="number">0</span>:<span class="number">1</span>/fs:T-<span class="number">1</span>/fs;  </span><br><span class="line">NT <span class="built_in">=</span> length(t);     <span class="comment">%一个脉冲中的采样点数，距离门数</span></span><br><span class="line"></span><br><span class="line">R1 <span class="built_in">=</span> <span class="number">5000</span>;        <span class="comment">%目标1距离</span></span><br><span class="line">V1 <span class="built_in">=</span> -<span class="number">10</span>;         <span class="comment">%目标1速度</span></span><br><span class="line">R2 <span class="built_in">=</span> <span class="number">1000</span>;        <span class="comment">%目标2距离</span></span><br><span class="line">V2 <span class="built_in">=</span><span class="number">0</span>;            <span class="comment">%目标2速度</span></span><br></pre></td></tr></table></figure>

<h4 id="回波生成"><a href="#回波生成" class="headerlink" title="回波生成"></a>回波生成</h4><p>如前所述</p>
<p>$$<br>\begin{array}{c}<br>    P_{IF_n} = 2 \pi {(f_I-\frac{B}{2}) (t - \tau_n ) + \frac{2v f_R t}{c} + \frac{k}{2} [(1+\frac{2v}{c})t-\tau_n]^2}+\phi_{IF} \<br>    (\tau_n \leq t \leq T*DR+\tau_n)<br>\end{array}<br>$$</p>
<p>生成中频信号,同时添加噪声</p>
<figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">fd1 <span class="built_in">=</span> <span class="number">2</span>*V1/lambda; <span class="comment">%多普勒频率1</span></span><br><span class="line">fd2 <span class="built_in">=</span> <span class="number">2</span>*V2/lambda; <span class="comment">%多普勒频率1</span></span><br><span class="line"></span><br><span class="line">echo1 <span class="built_in">=</span> zeros(M,NT); <span class="comment">%回波</span></span><br><span class="line">tao1 <span class="built_in">=</span> zeros(<span class="number">1</span>,M); </span><br><span class="line">N_tao1 <span class="built_in">=</span> zeros(<span class="number">1</span>,M); <span class="comment">%取整</span></span><br><span class="line">echo2 <span class="built_in">=</span> zeros(M,NT); <span class="comment">%回波</span></span><br><span class="line">tao2 <span class="built_in">=</span> zeros(<span class="number">1</span>,M);  <span class="comment">%多普勒</span></span><br><span class="line">N_tao2 <span class="built_in">=</span> zeros(<span class="number">1</span>,M); <span class="comment">%取整</span></span><br><span class="line"></span><br><span class="line">echo <span class="built_in">=</span> zeros(M,NT);</span><br><span class="line"></span><br><span class="line">t_fd <span class="built_in">=</span> <span class="number">0</span>:(<span class="number">1</span>/fs):(T*M-<span class="number">1</span>/fs);</span><br><span class="line"></span><br><span class="line">echo1_fd <span class="built_in">=</span> exp(<span class="number">1</span>i*<span class="number">2</span>*pi*fd1*t_fd); <span class="comment">%目标1在M个脉冲内引起的连续多普勒</span></span><br><span class="line">echo2_fd <span class="built_in">=</span> exp(<span class="number">1</span>i*<span class="number">2</span>*pi*fd2*t_fd); <span class="comment">%目标2在M个脉冲内引起的连续多普勒</span></span><br><span class="line"></span><br><span class="line">AD_data <span class="built_in">=</span> zeros(M,NT);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 模拟生成目标回波</span></span><br><span class="line">for m<span class="built_in">=</span><span class="number">1</span>:<span class="number">1</span>:M</span><br><span class="line">    </span><br><span class="line">    tao1(<span class="number">1</span>,m)<span class="built_in">=</span><span class="number">2</span>*(R1-V1*(m-<span class="number">1</span>)*T)/c;</span><br><span class="line">    N_tao1(<span class="number">1</span>,m) <span class="built_in">=</span> round(tao1(<span class="number">1</span>,m)*fs);</span><br><span class="line">    tao2(<span class="number">1</span>,m)<span class="built_in">=</span><span class="number">2</span>*(R2-V2*(m-<span class="number">1</span>)*T)/c;</span><br><span class="line">    N_tao2(<span class="number">1</span>,m) <span class="built_in">=</span> round(tao2(<span class="number">1</span>,m)*fs);</span><br><span class="line">    </span><br><span class="line">    for n<span class="built_in">=</span><span class="number">1</span>:<span class="number">1</span>:NT</span><br><span class="line">        <span class="built_in">if</span>(n &lt; N_tao1(<span class="number">1</span>,m))</span><br><span class="line">            echo1(m,n) <span class="built_in">=</span> <span class="number">0</span>;</span><br><span class="line">        elseif(( n&gt;<span class="built_in">=</span>N_tao1(<span class="number">1</span>,m) ) &amp;&amp; ( n<span class="built_in">&lt;=</span>(N_tao1(<span class="number">1</span>,m)+NTp) ))</span><br><span class="line">            echo1(m,n) <span class="built_in">=</span> exp(<span class="number">1</span>i*pi*k*((<span class="number">1</span>+<span class="number">2</span>*V1/c)*t(n)-tao1(<span class="number">1</span>,m)).^<span class="number">2</span>)*exp(-<span class="number">1</span>i*<span class="number">2</span>*pi*(f0-B/<span class="number">2</span>)*tao1(<span class="number">1</span>,m))*exp(<span class="number">1</span>i*<span class="number">2</span>*pi*(f0-B/<span class="number">2</span>)*t(n))*echo1_fd(<span class="number">1</span>,n+(m-<span class="number">1</span>)*NT);</span><br><span class="line">        <span class="built_in">else</span></span><br><span class="line">            echo1(m,n) <span class="built_in">=</span> <span class="number">0</span>;</span><br><span class="line">        end</span><br><span class="line">        </span><br><span class="line">         <span class="built_in">if</span>(n &lt; N_tao2(<span class="number">1</span>,m))</span><br><span class="line">            echo2(m,n) <span class="built_in">=</span> <span class="number">0</span>;</span><br><span class="line">        elseif(( n&gt;<span class="built_in">=</span>N_tao2(<span class="number">1</span>,m) ) &amp;&amp; ( n<span class="built_in">&lt;=</span>(N_tao2(<span class="number">1</span>,m)+NTp) ))</span><br><span class="line">            echo2(m,n) <span class="built_in">=</span> exp(<span class="number">1</span>i*pi*k*((<span class="number">1</span>+<span class="number">2</span>*V2/c)*t(n)-tao2(<span class="number">1</span>,m)).^<span class="number">2</span>)*exp(-<span class="number">1</span>i*<span class="number">2</span>*pi*(f0-B/<span class="number">2</span>)*tao2(<span class="number">1</span>,m))*exp(<span class="number">1</span>i*<span class="number">2</span>*pi*(f0-B/<span class="number">2</span>)*t(n))*echo2_fd(<span class="number">1</span>,n+(m-<span class="number">1</span>)*NT);</span><br><span class="line">        <span class="built_in">else</span></span><br><span class="line">            echo2(m,n) <span class="built_in">=</span> <span class="number">0</span>;</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    <span class="comment">%------在echo中添加高斯噪声------%</span></span><br><span class="line">    SNR1 <span class="built_in">=</span> -<span class="number">5</span>;  <span class="comment">% 信号1的信噪比dB</span></span><br><span class="line">    NOISE1<span class="built_in">=</span>randn(<span class="number">1</span>,NT);</span><br><span class="line">    </span><br><span class="line">    signal_power1 <span class="built_in">=</span> (<span class="number">1</span>/NTp)*(sum((echo1(m,:).*conj(echo1(m,:)))));</span><br><span class="line">    noise_variance1 <span class="built_in">=</span> signal_power1 / ( <span class="number">10</span>^(SNR1/<span class="number">10</span>) );</span><br><span class="line">    std_noise_n1 <span class="built_in">=</span> std(NOISE1);</span><br><span class="line">    NOISE1 <span class="built_in">=</span><span class="number">1</span>/ sqrt(noise_variance1)*NOISE1;</span><br><span class="line">    echo1(m,:)<span class="built_in">=</span>echo1(m,:)+(NOISE1+<span class="number">1</span>i*hilbert(NOISE1));</span><br><span class="line">    </span><br><span class="line">    SNR2 <span class="built_in">=</span> <span class="number">2</span>;  <span class="comment">% 信号2的信噪比dB</span></span><br><span class="line">    NOISE2<span class="built_in">=</span>randn(<span class="number">1</span>,NT);</span><br><span class="line"></span><br><span class="line">    signal_power2 <span class="built_in">=</span> (<span class="number">1</span>/NTp)*(sum((echo2(m,:).*conj(echo2(m,:)))));</span><br><span class="line">    noise_variance2 <span class="built_in">=</span> signal_power2 / ( <span class="number">10</span>^(SNR2/<span class="number">10</span>) );</span><br><span class="line">    std_noise_n2 <span class="built_in">=</span> std(NOISE2);</span><br><span class="line">    NOISE2 <span class="built_in">=</span> <span class="number">1</span>/sqrt(noise_variance1)*NOISE2;</span><br><span class="line">    echo2(m,:)<span class="built_in">=</span>echo2(m,:)+(NOISE2+<span class="number">1</span>i*hilbert(NOISE2));</span><br><span class="line">    <span class="comment">%------在echo中添加高斯噪声end------%</span></span><br><span class="line">    </span><br><span class="line">    echo(m,:) <span class="built_in">=</span> echo1(m,:)+ echo2(m,:);</span><br><span class="line">    AD_data(m,:) <span class="built_in">=</span> real( echo(m,:) );</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<h4 id="数字正交下变频（DDC）"><a href="#数字正交下变频（DDC）" class="headerlink" title="数字正交下变频（DDC）"></a>数字正交下变频（DDC）</h4><p>正交解调框图如下</p>
<p><img src="PDradar%5CDDC.jpg"></p>
<p>同时对下变频信号进行匹配滤波</p>
<figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% DDC</span></span><br><span class="line"></span><br><span class="line">local_I <span class="built_in">=</span> -sin(<span class="number">2</span>*pi*<span class="number">5</span>e6*t);   <span class="comment">%本振</span></span><br><span class="line">local_Q <span class="built_in">=</span> cos(<span class="number">2</span>*pi*<span class="number">5</span>e6*t);    </span><br><span class="line">lowpassFilter<span class="built_in">=</span>fir1(<span class="number">128</span>,<span class="number">1</span>/<span class="number">8</span>); </span><br><span class="line"></span><br><span class="line">PC_Coff <span class="built_in">=</span> exp(-<span class="number">1</span>i*pi*k*((-Tp/<span class="number">2</span>:<span class="number">1</span>/<span class="number">10</span>e6:Tp/<span class="number">2</span>).^<span class="number">2</span>));</span><br><span class="line"><span class="comment">% N_FFT = 500;   %根据运行结果调整</span></span><br><span class="line"><span class="comment">% H2 = conj(fft(h2,N_FFT));   %匹配滤波</span></span><br><span class="line"></span><br><span class="line">for m<span class="built_in">=</span><span class="number">1</span>:<span class="number">1</span>:M  </span><br><span class="line">    I_data_local(m,:) <span class="built_in">=</span> AD_data(m,:).*local_I;</span><br><span class="line">    Q_data_local(m,:) <span class="built_in">=</span> AD_data(m,:).*local_Q;</span><br><span class="line">    I_data_local_FIR(m,:)<span class="built_in">=</span>filter(lowpassFilter,<span class="number">1</span>,I_data_local(m,:));</span><br><span class="line">    Q_data_local_FIR(m,:)<span class="built_in">=</span>filter(lowpassFilter,<span class="number">1</span>,Q_data_local(m,:));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">%-----8倍抽取------%</span></span><br><span class="line">    Dec_I(m,:)<span class="built_in">=</span>I_data_local_FIR(m,<span class="number">1</span>:<span class="number">8</span>:end);</span><br><span class="line">    Dec_Q(m,:)<span class="built_in">=</span>Q_data_local_FIR(m,<span class="number">1</span>:<span class="number">8</span>:end);</span><br><span class="line">    </span><br><span class="line">    DDC_data_out(m,:) <span class="built_in">=</span> Dec_Q(m,:) + <span class="number">1</span>i*Dec_I(m,:);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">%-----匹配滤波-----%</span></span><br><span class="line"><span class="comment">%     temp(m,:) = fft(DDC_data_out(m,:),N_FFT);</span></span><br><span class="line"><span class="comment">%     PC_data_fft(m,:) = temp(m,:).*H2;  </span></span><br><span class="line"><span class="comment">%     PC_data_ifft(m,:) = ifft(PC_data_fft(m,:),N_FFT);</span></span><br><span class="line">    </span><br><span class="line">    PC(m,:) <span class="built_in">=</span>conv(PC_Coff,DDC_data_out(m,:));</span><br><span class="line">    PC_data(m,:) <span class="built_in">=</span> PC(m,(length(PC_Coff)+<span class="number">9</span>:end -length(PC_Coff)-<span class="number">9</span>));</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>对匹配滤波的结果进行评估</p>
<p>$$<br>\begin{array}{c}<br>    SNR_1 = -5dB \<br>    SNR_2 = 3dB\<br>    SNR_{1_{out}} = 28.37dB\<br>    SNR_{2_{out}} = 32.15dB\<br>\end{array}<br>$$</p>
<p><img src="PDradar%5CPluseCompress.jpg"></p>
<h4 id="MTI与MTD"><a href="#MTI与MTD" class="headerlink" title="MTI与MTD"></a>MTI与MTD</h4><p>对匹配滤波后的矩阵进行一次对消<br><img src="PDradar%5CMTIschem.jpg"></p>
<figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% MTI</span></span><br><span class="line">for m<span class="built_in">=</span><span class="number">1</span>:<span class="number">1</span>:M-<span class="number">1</span></span><br><span class="line">    MTI_data(m,:) <span class="built_in">=</span> PC_data(m+<span class="number">1</span>,:) - PC_data(m,:);</span><br><span class="line">end</span><br><span class="line">figure</span><br><span class="line">mesh(abs(MTI_data));</span><br></pre></td></tr></table></figure>

<p><img src="PDradar%5CMTI.jpg"></p>
<p>对MTI的矩阵进行如下处理<br><img src="PDradar%5CMTDschem.jpg"></p>
<figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% MTD</span></span><br><span class="line">for l <span class="built_in">=</span> <span class="number">1</span>:<span class="number">1</span>:length(MTI_data(<span class="number">1</span>,:))</span><br><span class="line">    MTD_data(:,l) <span class="built_in">=</span>fftshift( fft(MTI_data(:,l)));  <span class="comment">%对每一列FFT（相参积累）</span></span><br><span class="line">end</span><br><span class="line">figure</span><br><span class="line">mesh(abs(MTD_data));</span><br></pre></td></tr></table></figure>



<p><img src="PDradar%5CMTD.jpg"></p>
<h4 id="相参积累"><a href="#相参积累" class="headerlink" title="相参积累"></a>相参积累</h4><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 相参积累</span></span><br><span class="line"></span><br><span class="line">for l <span class="built_in">=</span> <span class="number">1</span>:<span class="number">1</span>:length(PC_data(<span class="number">1</span>,:))</span><br><span class="line">    PC_data_CA(:,l) <span class="built_in">=</span>fftshift( fft(PC_data(:,l)));  <span class="comment">%对每一列FFT（相参积累）</span></span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">figure</span><br><span class="line">x <span class="built_in">=</span>(<span class="number">1</span>:length(PC_data_CA(<span class="number">1</span>,:))) *c/<span class="number">10</span>e6/<span class="number">2</span>;</span><br><span class="line">y <span class="built_in">=</span> (-round( length(PC_data_CA(:,<span class="number">1</span>))/<span class="number">2</span>  ):<span class="number">1</span>:round( length(PC_data_CA(:,<span class="number">1</span>))/<span class="number">2</span> )-<span class="number">1</span> ) *lambda/( <span class="number">2</span>*T*length(PC_data_CA(:,<span class="number">1</span>)) ); </span><br><span class="line">mesh(x,y ,abs(PC_data_CA));</span><br><span class="line">title(<span class="string">&#x27;相参处理结果&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;距离&#x27;</span>);ylabel(<span class="string">&#x27;速度&#x27;</span>);</span><br><span class="line">set(gca,<span class="string">&#x27;Ydir&#x27;</span>,<span class="string">&#x27;reverse&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>经过数字下变频，匹配滤波，相参处理后得到如下结果。<br><img src="PDradar%5CPhCoh.jpg"></p>
<h4 id="一个匹配滤波小实验"><a href="#一个匹配滤波小实验" class="headerlink" title="一个匹配滤波小实验"></a>一个匹配滤波小实验</h4><p>使用一单频连续波测速雷达，沿垂直其主瓣照射方向匀速推动，示意图如下：<br><img src="PDradar%5CPCmodel.jpg"></p>
<p>实际雷达照射面下的物体如下：<br><img src="PDradar%5CPCsence.jpg"></p>
<figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">IData <span class="built_in">=</span>  csvread(<span class="string">&#x27;Q6.csv&#x27;</span>);</span><br><span class="line">QData <span class="built_in">=</span>  csvread(<span class="string">&#x27;I6.csv&#x27;</span>);</span><br><span class="line"></span><br><span class="line">IData <span class="built_in">=</span> IData(:,<span class="number">2</span>);</span><br><span class="line">QData <span class="built_in">=</span> QData(:,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">EchoData <span class="built_in">=</span> QData + <span class="number">1</span>i*IData;</span><br><span class="line">EchoData <span class="built_in">=</span> EchoData(<span class="number">1</span>:<span class="number">10</span>:<span class="number">70000</span>);</span><br><span class="line">sizeEchoData <span class="built_in">=</span> size(EchoData);</span><br><span class="line">EchoData <span class="built_in">=</span> reshape(EchoData,[<span class="number">1</span>,sizeEchoData(<span class="number">1</span>)]);</span><br><span class="line"></span><br><span class="line">load(<span class="string">&#x27;D:\Matlab2018a\SpeedDetect\GaussianWin_Point256_Alpha2_5.mat&#x27;</span>);</span><br><span class="line">WinLength <span class="built_in">=</span> length(GaussianWin_Point256_Alpha2_5);</span><br><span class="line">Step <span class="built_in">=</span> <span class="number">20</span>;</span><br><span class="line">tEchoData <span class="built_in">=</span> (<span class="number">1</span>/<span class="number">25000</span> :<span class="number">1</span>/<span class="number">25000</span> :<span class="number">7000</span>*<span class="number">1</span>/<span class="number">25000</span>);</span><br><span class="line">figure</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">plot(tEchoData,real(EchoData));xlabel(<span class="string">&#x27;时间（s）&#x27;</span>);ylabel(<span class="string">&#x27;幅值（V）&#x27;</span>);title(<span class="string">&#x27;时域波形（实）&#x27;</span>);</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">plot(tEchoData,imag(EchoData));xlabel(<span class="string">&#x27;时间（s）&#x27;</span>);ylabel(<span class="string">&#x27;幅值（V）&#x27;</span>);title(<span class="string">&#x27;时域波形（虚）&#x27;</span>);</span><br><span class="line"></span><br><span class="line">result<span class="built_in">=</span>STFT(EchoData,GaussianWin_Point256_Alpha2_5,WinLength,Step);</span><br><span class="line"></span><br><span class="line">Fs <span class="built_in">=</span> <span class="number">2.5</span>e3;</span><br><span class="line">sizeResult <span class="built_in">=</span> size(result);</span><br><span class="line">t <span class="built_in">=</span> <span class="number">1</span>/Fs*Step:<span class="number">1</span>/Fs*Step:sizeResult(<span class="number">1</span>)*<span class="number">1</span>/Fs*Step;</span><br><span class="line">v <span class="built_in">=</span> -(WinLength-<span class="number">1</span>)/<span class="number">2</span>*Fs/WinLength/<span class="number">161</span> : Fs/WinLength/<span class="number">161</span> :  (WinLength-<span class="number">1</span>)/<span class="number">2</span>*Fs/WinLength/<span class="number">161</span>;</span><br><span class="line">figure</span><br><span class="line">imagesc(v,t,abs(result));ylabel(<span class="string">&#x27;时间（s）&#x27;</span>);xlabel(<span class="string">&#x27;速度（m/s）&#x27;</span>);title(<span class="string">&#x27;短时傅里叶分析结果&#x27;</span>);</span><br><span class="line"></span><br><span class="line">Fs <span class="built_in">=</span> <span class="number">2.5</span>e3;</span><br><span class="line">angle_max <span class="built_in">=</span> <span class="number">10</span>/<span class="number">360</span>*<span class="number">2</span>*pi;</span><br><span class="line">h <span class="built_in">=</span> <span class="number">1.21</span>;</span><br><span class="line">d <span class="built_in">=</span> tan(angle_max)*h;</span><br><span class="line">va <span class="built_in">=</span> <span class="number">1.15</span>;<span class="comment">%2.34</span></span><br><span class="line"></span><br><span class="line">t_total <span class="built_in">=</span> d*<span class="number">2</span>/va;</span><br><span class="line">t <span class="built_in">=</span> <span class="number">0</span>:<span class="number">1</span>/Fs:t_total;</span><br><span class="line"></span><br><span class="line">angle_now <span class="built_in">=</span> atan( ( d*ones(<span class="number">1</span>,length(t))- va*t)/h );</span><br><span class="line">v_alpha <span class="built_in">=</span> va * sin(angle_now);</span><br><span class="line"></span><br><span class="line">fc <span class="built_in">=</span> <span class="number">24.15</span>e9;</span><br><span class="line">c <span class="built_in">=</span> <span class="number">3</span>e8;</span><br><span class="line"></span><br><span class="line">desire_signal <span class="built_in">=</span> exp(<span class="number">1</span>i*v_alpha*<span class="number">2</span>*fc/c);</span><br><span class="line">result <span class="built_in">=</span> xcorr(EchoData,conj(desire_signal));</span><br><span class="line">result <span class="built_in">=</span> abs(result(<span class="number">6000</span>:length(result)));</span><br><span class="line"></span><br><span class="line">figure</span><br><span class="line">imagesc(abs(result));ylabel(<span class="string">&#x27;能量维&#x27;</span>);xlabel(<span class="string">&#x27;时间维&#x27;</span>);title(<span class="string">&#x27;脉冲压缩&#x27;</span>);</span><br><span class="line">figure</span><br><span class="line">plot(abs(result));ylabel(<span class="string">&#x27;能量维&#x27;</span>);xlabel(<span class="string">&#x27;时间维&#x27;</span>);title(<span class="string">&#x27;脉冲压缩&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>实际回波的波形为<br><img src="PDradar%5CPCrec.jpg"><br>短时傅里叶分析结果为<br><img src="PDradar%5CPCstft.jpg"><br>脉冲压缩的结果为<br><img src="PDradar%5CPCresult.jpg"></p>
<h2 id="连续波体制"><a href="#连续波体制" class="headerlink" title="连续波体制"></a>连续波体制</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">YXY</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Mr-Bulijiojio" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Mr-Bulijiojio" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/frompyrmaidinside@gmail.com" title="E-Mail → frompyrmaidinside@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YXY</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
